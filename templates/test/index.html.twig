{% block body %}
<canvas id="chart" width="1000" height="200"></canvas>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"
    integrity="sha512-s+xg36jbIujB2S2VKfpGmlC3T5V2TF3lY48DX7u2r9XzGzgPsa6wTpOQA7J9iffvdeBN0q9tKzRxVxw1JviZPg=="
    crossorigin="anonymous"></script>
<script>
    var data = {
        {
            data | raw
        }
    };
    var labels = data.map(function (item) {
        return item.name;
    });
    var values = data.map(function (item) {
        return item.salary;
    });

    var ctx = document.getElementById('chart').getContext('2d');
    var myChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: labels,
            datasets: [{
                label: 'Salary',
                data: values,
                backgroundColor: 'rgba(54, 162, 235, 0.2)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 2
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });
</script>


<div style="position: absolute; margin-left:400px; margin-top: 100px">
    <h1 id="dd1"> Liste des utilisateurs</h1>
    <th style="text-align:center;"></th>


    </br>
    <input type="text" id="search" class="form-control" placeholder="Search">
    <div>
        <table id="t" class="table table-striped ">
            <thead class="thead-dark">
                <tr>
                    <th>name</th>
                    <th>description</th>
                    <th>salary</th>
                    <th>duration</th>
                    <th>keywords</th>

                </tr>
            </thead>
            <tbody id="all">
                {% for offer in offers %}
                <tr>
                    <td>{{offer.name}}</td>
                    <td>{{ offer.description }}</td>

                    <td>{{ offer.salary }}</td>
                    <td>{{ offer.duration }}</td>
                    <td>{{ offer.keywords }}</td>
                    <td>

    </div>
    </tr>
    {% endfor %}
    </tbody>
    <tbody id="searchtab">
    </tbody>
    </table>

</div>
{% block js %}
<script src={{ asset('https://code.jquery.com/jquery-3.5.1.min.js') }}></script>


<script>
    $(document).ready(function () {
        $("#search").keyup(function (e) {
            /* La variable value va prendre la valeur insérer dans le champ de texte
            afin d'effectuer la recherche */
            var value = $(this).val();
            /* Ajax est lancé lors du remplissage du champ texte dont l'id est
            « search » pour faire la recherche */

            $.ajax({
                /* l’url est une chaine de caractères contenant l’adresse où la requête est
                envoyée */
                url: "{{ path('recherche_offre_ajax') }}",
                /* La méthode utilisée pour transférer les données est GET */
                type: 'GET',
                /*Ici search value va prendre la chaine entrée par un utilisateur dans la
                zone de recherche et sera placée après l’url */
                data: {
                    'searchValue': value
                },
                /*Cette fonction permet de vider le contenu du tableau pour recevoir le
                nouveau contenu*/
                success: function (resultats) {
                    if (resultats) {
                        $('#t tbody#searchtab').empty();
                        $.each(resultats, function (i, obj) {
                            $('#t tbody#all').hide();
                            $('#t tbody#searchtab').append('<tr><td> ' + obj.name +
                                '</td><td> ' + obj.description + '</td><td> ' +
                                obj
                                .salary + '</td><td> ' + obj.duration +
                                '</td><td> ' + obj.keywords '</td></tr>');
                        });
                    } else {
                        $('#t tbody#all').show();
                        $('#t tbody#searchtab').empty();
                        $('#t tbody#searchtab').fadeIn('fast');
                    }
                },
            });
            return false;
        });

    });
</script>
{% endblock %}
{% endblock %}